{"version":3,"sources":["app_final_new.js"],"names":["createError","require","express","cookieParser","session","path","indexRouter","logger","authRouter","pemainRouter","flash","reservasiRouter","arenaRouter","bookingRouter","usersRouter","ulasanRouter","pembayaranRouter","app","set","join","__dirname","use","json","jadwalRouter","urlencoded","extended","secret","venuesRouter","resave","saveUninitialized","cookie","fotoRouter","maxAge","notifikasiRouter","req","Model_Notifikasi","regeneratorRuntime","async","_context","prev","next","success_msg","user","role","awrap","getByUser","id","res","locals","notifications","sent","getUnreadCount","unreadCount","t0","console","error","stop","adminRouter","err","message","status","render","title","module","exports","port","process","env","PORT","listen"],"mappings":"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","file":"app_final_new.min.js","sourcesContent":["var createError = require('http-errors');\r\nvar express = require('express');\r\nvar path = require('path');\r\nvar cookieParser = require('cookie-parser');\r\nvar logger = require('morgan');\r\nvar session = require('express-session');\r\nvar flash = require('connect-flash');\r\n\r\n// Impor Rute\r\nvar indexRouter = require('./routes/index');\r\nvar usersRouter = require('./routes/users'); // Rute CRUD Master User\r\nvar authRouter = require('./routes/auth'); // Rute Login/Register\r\nvar adminRouter = require('./routes/admin'); // Rute Dashboard Admin\r\nvar pemainRouter = require('./routes/pemain'); // Rute Dashboard Pemain\r\nvar jadwalRouter = require('./routes/jadwal');\r\nconst reservasiRouter = require('./routes/reservasi');\r\nvar arenaRouter = require('./routes/arena');\r\nvar venuesRouter = require('./routes/venues');\r\nvar bookingRouter = require('./routes/booking');\r\nvar fotoRouter = require('./routes/foto');\r\nvar ulasanRouter = require('./routes/ulasan');\r\nvar pembayaranRouter = require('./routes/pembayaran');\r\nvar notifikasiRouter = require('./routes/notifikasi');\r\nvar app = express();\r\n\r\n// view engine setup\r\napp.set('views', path.join(__dirname, 'views'));\r\napp.set('view engine', 'ejs');\r\n\r\napp.use(logger('dev'));\r\napp.use(express.json());\r\napp.use(express.urlencoded({ extended: false }));\r\napp.use(cookieParser());\r\napp.use(express.static(path.join(__dirname, 'public')));\r\n\r\n// Konfigurasi Session (Tanpa .env)\r\napp.use(session({\r\n  secret: 'kunci-rahasia-untuk-arenago-project', // Kunci rahasia\r\n  resave: false,\r\n  saveUninitialized: true,\r\n  cookie: {\r\n    secure: false, // Set 'true' jika pakai HTTPS\r\n    maxAge: 1000 * 60 * 60 * 24 // Cookie berlaku 1 hari\r\n  }\r\n}));\r\n\r\n// Konfigurasi Flash Message\r\napp.use(flash());\r\n\r\n// [Middleware Global PENTING]\r\n// Mengirim pesan flash & info user ke SEMUA file .ejs\r\napp.use(async (req, res, next) => {\r\n  res.locals.success_msg = req.flash('success_msg');\r\n  res.locals.error_msg = req.flash('error_msg');\r\n  res.locals.user = req.session.user || null; // Info user yang login\r\n\r\n  // Jika user adalah pemain, ambil notifikasi\r\n  if (req.session.user && req.session.user.role === 'pemain') {\r\n    const Model_Notifikasi = require('./models/Model_Notifikasi_new');\r\n    try {\r\n      res.locals.notifications = await Model_Notifikasi.getByUser(req.session.user.id);\r\n      res.locals.unreadCount = await Model_Notifikasi.getUnreadCount(req.session.user.id);\r\n    } catch (err) {\r\n      console.error('Error loading notifications:', err);\r\n      res.locals.notifications = [];\r\n      res.locals.unreadCount = 0;\r\n    }\r\n  } else {\r\n    res.locals.notifications = [];\r\n    res.locals.unreadCount = 0;\r\n  }\r\n\r\n  next();\r\n});\r\n\r\n// Pendaftaran Rute\r\napp.use('/', indexRouter);\r\napp.use('/auth', authRouter);\r\napp.use('/admin', adminRouter);\r\napp.use('/pemain', pemainRouter);\r\napp.use('/users', usersRouter); // Ini untuk CRUD Master User oleh Admin\r\napp.use('/arena', arenaRouter);\r\napp.use('/admin/reservasi', reservasiRouter);\r\napp.use('/jadwal', jadwalRouter);\r\napp.use('/venues', venuesRouter);\r\napp.use('/booking', bookingRouter);\r\napp.use('/foto', fotoRouter);\r\napp.use('/ulasan', ulasanRouter);\r\napp.use('/admin/pembayaran', pembayaranRouter);\r\napp.use('/notifikasi', notifikasiRouter);\r\n// catch 404 and forward to error handler\r\napp.use(function(req, res, next) {\r\n  next(createError(404));\r\n});\r\n\r\n// error handler\r\napp.use(function(err, req, res, next) {\r\n  // set locals, only providing error in development\r\n  res.locals.message = err.message;\r\n  res.locals.error = req.app.get('env') === 'development' ? err : {};\r\n\r\n  // render the error page\r\n  res.status(err.status || 500);\r\n  res.render('error', { title: 'Error' });\r\n});\r\n\r\nmodule.exports = app;\r\n\r\n// Start server\r\nconst port = process.env.PORT || 3000;\r\napp.listen(port, () => {\r\n  console.log(`Server running on port ${port}`);\r\n});\r\n"]}