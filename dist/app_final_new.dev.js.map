{"version":3,"sources":["app_final_new.js"],"names":["createError","require","express","path","cookieParser","logger","session","flash","indexRouter","usersRouter","authRouter","adminRouter","pemainRouter","jadwalRouter","reservasiRouter","arenaRouter","venuesRouter","bookingRouter","fotoRouter","ulasanRouter","pembayaranRouter","notifikasiRouter","app","set","join","__dirname","use","json","urlencoded","extended","secret","resave","saveUninitialized","cookie","secure","maxAge","req","res","next","locals","success_msg","error_msg","user","role","Model_Notifikasi","getByUser","id","notifications","getUnreadCount","unreadCount","console","error","err","message","get","status","render","title","module","exports","port","process","env","PORT","listen","log"],"mappings":"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","sourcesContent":["var createError = require('http-errors');\r\nvar express = require('express');\r\nvar path = require('path');\r\nvar cookieParser = require('cookie-parser');\r\nvar logger = require('morgan');\r\nvar session = require('express-session');\r\nvar flash = require('connect-flash');\r\n\r\n// Impor Rute\r\nvar indexRouter = require('./routes/index');\r\nvar usersRouter = require('./routes/users'); // Rute CRUD Master User\r\nvar authRouter = require('./routes/auth'); // Rute Login/Register\r\nvar adminRouter = require('./routes/admin'); // Rute Dashboard Admin\r\nvar pemainRouter = require('./routes/pemain'); // Rute Dashboard Pemain\r\nvar jadwalRouter = require('./routes/jadwal');\r\nconst reservasiRouter = require('./routes/reservasi');\r\nvar arenaRouter = require('./routes/arena');\r\nvar venuesRouter = require('./routes/venues');\r\nvar bookingRouter = require('./routes/booking');\r\nvar fotoRouter = require('./routes/foto');\r\nvar ulasanRouter = require('./routes/ulasan');\r\nvar pembayaranRouter = require('./routes/pembayaran');\r\nvar notifikasiRouter = require('./routes/notifikasi');\r\nvar app = express();\r\n\r\n// view engine setup\r\napp.set('views', path.join(__dirname, 'views'));\r\napp.set('view engine', 'ejs');\r\n\r\napp.use(logger('dev'));\r\napp.use(express.json());\r\napp.use(express.urlencoded({ extended: false }));\r\napp.use(cookieParser());\r\napp.use(express.static(path.join(__dirname, 'public')));\r\n\r\n// Konfigurasi Session (Tanpa .env)\r\napp.use(session({\r\n  secret: 'kunci-rahasia-untuk-arenago-project', // Kunci rahasia\r\n  resave: false,\r\n  saveUninitialized: true,\r\n  cookie: {\r\n    secure: false, // Set 'true' jika pakai HTTPS\r\n    maxAge: 1000 * 60 * 60 * 24 // Cookie berlaku 1 hari\r\n  }\r\n}));\r\n\r\n// Konfigurasi Flash Message\r\napp.use(flash());\r\n\r\n// [Middleware Global PENTING]\r\n// Mengirim pesan flash & info user ke SEMUA file .ejs\r\napp.use(async (req, res, next) => {\r\n  res.locals.success_msg = req.flash('success_msg');\r\n  res.locals.error_msg = req.flash('error_msg');\r\n  res.locals.user = req.session.user || null; // Info user yang login\r\n\r\n  // Jika user adalah pemain, ambil notifikasi\r\n  if (req.session.user && req.session.user.role === 'pemain') {\r\n    const Model_Notifikasi = require('./models/Model_Notifikasi_new');\r\n    try {\r\n      res.locals.notifications = await Model_Notifikasi.getByUser(req.session.user.id);\r\n      res.locals.unreadCount = await Model_Notifikasi.getUnreadCount(req.session.user.id);\r\n    } catch (err) {\r\n      console.error('Error loading notifications:', err);\r\n      res.locals.notifications = [];\r\n      res.locals.unreadCount = 0;\r\n    }\r\n  } else {\r\n    res.locals.notifications = [];\r\n    res.locals.unreadCount = 0;\r\n  }\r\n\r\n  next();\r\n});\r\n\r\n// Pendaftaran Rute\r\napp.use('/', indexRouter);\r\napp.use('/auth', authRouter);\r\napp.use('/admin', adminRouter);\r\napp.use('/pemain', pemainRouter);\r\napp.use('/users', usersRouter); // Ini untuk CRUD Master User oleh Admin\r\napp.use('/arena', arenaRouter);\r\napp.use('/admin/reservasi', reservasiRouter);\r\napp.use('/jadwal', jadwalRouter);\r\napp.use('/venues', venuesRouter);\r\napp.use('/booking', bookingRouter);\r\napp.use('/foto', fotoRouter);\r\napp.use('/ulasan', ulasanRouter);\r\napp.use('/admin/pembayaran', pembayaranRouter);\r\napp.use('/notifikasi', notifikasiRouter);\r\n// catch 404 and forward to error handler\r\napp.use(function(req, res, next) {\r\n  next(createError(404));\r\n});\r\n\r\n// error handler\r\napp.use(function(err, req, res, next) {\r\n  // set locals, only providing error in development\r\n  res.locals.message = err.message;\r\n  res.locals.error = req.app.get('env') === 'development' ? err : {};\r\n\r\n  // render the error page\r\n  res.status(err.status || 500);\r\n  res.render('error', { title: 'Error' });\r\n});\r\n\r\nmodule.exports = app;\r\n\r\n// Start server\r\nconst port = process.env.PORT || 3000;\r\napp.listen(port, () => {\r\n  console.log(`Server running on port ${port}`);\r\n});\r\n"],"file":"app_final_new.dev.js"}