{"version":3,"sources":["authMiddleware.js"],"names":["isAuthenticated","req","res","next","session","user","flash","redirect","isAdmin","role","isPemain","module","exports"],"mappings":"aACA,IAAMA,gBAAkB,SAACC,EAAKC,EAAKC,GADnC,GAAAF,EAAAG,QAAAC,KACML,OAAAA,IAEFC,EAAAK,MAAOH,YAAP,iDACDD,EAAAK,SAAA,gBAKHC,QAAA,SAAAP,EAAAC,EAAAC,GAEE,GAAIF,EAAIG,QAAQC,MAAkC,UAA1BJ,EAAIG,QAAQC,KAAKI,KACvC,OAAON,IADTF,EAAIA,MAAIG,YAAJ,4CACFF,EAAAK,SAAW,sBAGTA,SAAS,SAAAN,EAAAC,EAAAC,GAKb,GAFFF,EAAAG,QAAAC,MAAA,WAAAJ,EAAAG,QAAAC,KAAAI,KAGI,OAAON,IAFXF,EAAMS,MAAQ,YAARA,6CACJR,EAAID,SAAIG,qBAOVO,OAAOC,QAAU,CAJfX,gBAAAA,gBACAC,QAAAA,QALFQ,SAAAA","file":"authMiddleware.min.js","sourcesContent":["// Cek apakah user sudah login\r\nconst isAuthenticated = (req, res, next) => {\r\n  if (req.session.user) {\r\n    return next(); \r\n  }\r\n  req.flash('error_msg', 'Anda harus login untuk mengakses halaman ini.');\r\n  res.redirect('/auth/login');\r\n};\r\n\r\n// Cek role Admin\r\nconst isAdmin = (req, res, next) => {\r\n  if (req.session.user && req.session.user.role === 'admin') {\r\n    return next(); // Lanjut jika rolenya 'admin'\r\n  }\r\n  req.flash('error_msg', 'Akses ditolak. Halaman ini khusus Admin.');\r\n  res.redirect('/pemain/dashboard'); // Redirect pemain ke dashboardnya\r\n};\r\n\r\n// Cek role Pemain\r\nconst isPemain = (req, res, next) => {\r\n  if (req.session.user && req.session.user.role === 'pemain') {\r\n    return next(); // Lanjut jika rolenya 'pemain'\r\n  }\r\n  req.flash('error_msg', 'Akses ditolak. Halaman ini khusus Pemain.');\r\n  res.redirect('/admin/dashboard'); \r\n};\r\n\r\nmodule.exports = {\r\n  isAuthenticated,\r\n  isAdmin,\r\n  isPemain\r\n};"]}