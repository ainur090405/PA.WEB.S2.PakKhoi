{"version":3,"sources":["Model_Jadwal.js"],"names":["connection","require","Model_Jadwal","Promise","resolve","reject","sql","query","err","rows","id","id_arena","sesiData","values","map","sesi","tanggal","jam_mulai","jam_selesai","status_slot","result","Data","id_jadwal","data","module","exports"],"mappings":"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","sourcesContent":["// models/Model_Jadwal.js\r\nconst connection = require('../config/database');\r\n\r\nclass Model_Jadwal {\r\n\r\n  // FUNGSI BARU: Ambil semua jadwal (JOIN dengan arena)\r\n  static async getAll() {\r\n    return new Promise((resolve, reject) => {\r\n      const sql = `\r\n        SELECT j.*, a.nama_arena \r\n        FROM jadwal j\r\n        JOIN arena a ON j.id_arena = a.id_arena\r\n        ORDER BY j.tanggal DESC, j.jam_mulai ASC\r\n      `;\r\n      connection.query(sql, (err, rows) => {\r\n        if (err) reject(err); else resolve(rows);\r\n      });\r\n    });\r\n  }\r\nstatic async getById(id) {\r\n    return new Promise((resolve, reject) => {\r\n      const sql = `\r\n        SELECT j.*, a.nama_arena, a.jam_buka, a.jam_tutup \r\n        FROM jadwal j\r\n        JOIN arena a ON j.id_arena = a.id_arena\r\n        WHERE j.id_jadwal = ?\r\n      `;\r\n      connection.query(sql, [id], (err, rows) => {\r\n        if (err) reject(err); else resolve(rows);\r\n      });\r\n    });\r\n  }\r\n  // FUNGSI BARU: Ambil semua jadwal masa depan untuk 1 arena (termasuk yang sudah terisi, untuk tampilan)\r\n  static async getAvailableByArenaId(id_arena) {\r\n    return new Promise((resolve, reject) => {\r\n      const sql = `\r\n        SELECT * FROM jadwal\r\n        WHERE id_arena = ?\r\n          AND (\r\n            tanggal > CURDATE()  -- Hari mendatang\r\n            OR (tanggal = CURDATE() AND jam_mulai > CURTIME())  -- Hari ini tapi jam belum lewat\r\n          )\r\n        ORDER BY tanggal ASC, jam_mulai ASC\r\n      `;\r\n      connection.query(sql, [id_arena], (err, rows) => {\r\n        if (err) reject(err); else resolve(rows);\r\n      });\r\n    });\r\n  }\r\n  // FUNGSI BARU UNTUK GENERATOR\r\n  static async StoreMany(sesiData) {\r\n    return new Promise((resolve, reject) => {\r\n      // 1. Ubah array of objects [{}, {}] menjadi array of arrays [[], []]\r\n      const values = sesiData.map(sesi => [\r\n        sesi.id_arena,\r\n        sesi.tanggal,\r\n        sesi.jam_mulai,\r\n        sesi.jam_selesai,\r\n        sesi.status_slot\r\n      ]);\r\n\r\n      // 2. Query SQL untuk bulk insert (menyimpan banyak data sekaligus)\r\n      const sql = 'INSERT INTO jadwal (id_arena, tanggal, jam_mulai, jam_selesai, status_slot) VALUES ?';\r\n      \r\n      connection.query(sql, [values], (err, result) => {\r\n        if (err) reject(err);\r\n        else resolve(result);\r\n      });\r\n    });\r\n  }\r\n  // FUNGSI BARU: Simpan jadwal baru\r\n  static async Store(Data) {\r\n    return new Promise((resolve, reject) => {\r\n      connection.query('INSERT INTO jadwal SET ?', Data, (err, result) => {\r\n        if (err) reject(err); else resolve(result);\r\n      });\r\n    });\r\n  }\r\nstatic async Update(id_jadwal, data) {\r\n  return new Promise((resolve, reject) => {\r\n    const sql = 'UPDATE jadwal SET ? WHERE id_jadwal = ?';\r\n    connection.query(sql, [data, id_jadwal], (err, result) => {\r\n      if (err) reject(err);\r\n      else resolve(result);\r\n    });\r\n  });\r\n}\r\n\r\n\r\n  // FUNGSI BARU: Hapus jadwal\r\n  static async Delete(id) {\r\n    return new Promise((resolve, reject) => {\r\n      connection.query('DELETE FROM jadwal WHERE id_jadwal = ?', [id], (err, result) => {\r\n        if (err) reject(err); else resolve(result);\r\n      });\r\n    });\r\n  }\r\n}\r\n\r\nmodule.exports = Model_Jadwal;"],"file":"Model_Jadwal.dev.js"}