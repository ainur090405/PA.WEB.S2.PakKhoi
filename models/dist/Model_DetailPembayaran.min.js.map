{"version":3,"sources":["Model_DetailPembayaran.js"],"names":["Model_Pembayaran","require","Model_DetailPembayaran","id_reservasi","getByReservasi","rows","length","p","id_detail","id_pembayaran","metode_pembayaran","status_pembayaran","bukti_pembayaran","status_bukti","catatan_admin","konfirmasi_admin","created_at","updated_at","data","insert","Date","Store","undefined","mapped","Object","assign","Update","filename","uploadBuktiByReservasi","module","exports"],"mappings":"mZAAA,IAAMA,iBAAmBC,QAAQ,sBAE3BC,wIAIwBC,oIACPH,iBAAiBI,eAAeD,eAA7CE,WAPuB,IAA3BL,EAAgBM,gDAAW,kBASvBC,EAAIF,EAAK,qBAER,CAAC,CACNG,UAAWD,EAAEE,cACbN,aAAcI,EAAEJ,aAChBO,kBAAmBH,EAAEG,kBACrBC,kBAAmBJ,EAAEI,kBACrBC,iBAAkBL,EAAEK,iBACpBC,aAAcN,EAAEM,aAChBC,cAAeP,EAAEO,cAdrBC,iBAAAR,EAAAQ,iBACAC,WAAAT,EAAAS,WAgBIC,WAAYV,EAAEU,iFAKEC,gGACZC,EAAS,CACbhB,aAAce,EAAKf,aACnBO,kBAAmBQ,EAAKR,mBAAqB,YAC7CC,kBAAmBO,EAAKP,mBAAqB,SAvBzCN,iBAwBca,EAAKN,kBAAoB,KAC3CC,aAAcK,EAAKL,cAAgB,UACnCC,cAzBGT,EAADS,eAAS,KA0BXC,iBAAkBG,EAAKH,mBAAoB,EAC3CC,WAAY,IAAII,KAChBH,WAAY,IAAIG,wBAEXpB,iBAAiBqB,MAAMF,kFAIDhB,EA/BtBe,sIACLV,iBAAaC,eADPN,cACNK,SACAL,EAAAA,QAEmBI,IAAnBI,EAAAA,oBAAqBA,EAAAA,kBAJfO,EAAAR,wBAKaY,IAAnBV,EAAAA,oBAAoBA,EALdD,kBAAAO,EAAAP,wBAMUE,IAAhBA,EAAAA,mBANMU,EAAAX,iBAAAM,EAAAN,uBAOOU,IAAbR,EAAAA,eAAiBA,EAPXD,aAAAK,EAAAL,mBAQNE,IAAAA,EAAAA,gBAAoBA,EAAAA,cARdG,EAAAJ,oBASQE,IAAdA,EAAAA,mBATMO,EAAAR,iBAAAG,EAAAH,kBAUNE,EAAAA,WAAAA,IAAYV,KAiCTF,GAAwB,IAAhBA,EAAKC,+BACVa,EAASK,OAAOC,OAAO,CAAEtB,aAAAA,EAAca,WAAY,IAAII,MAAUG,qBAChEvB,iBAAiBqB,MAAMF,qCAEvBnB,iBAAiB0B,OAAOrB,EAAK,GAAGI,cAAec,6EAKjCpB,EAAcwB,4GAC9B3B,iBAAiB4B,uBAAuBzB,EAAcwB,iDAIjEE,OAAOC,QAAU5B","file":"Model_DetailPembayaran.min.js","sourcesContent":["const Model_Pembayaran = require('./Model_Pembayaran');\r\n\r\nclass Model_DetailPembayaran {\r\n\r\n  // Kembalikan \"detail\" berdasarkan id_reservasi\r\n  // Format array 1 elemen, mirip hasil query dulu.\r\n  static async getByReservasi(id_reservasi) {\r\n    const rows = await Model_Pembayaran.getByReservasi(id_reservasi);\r\n    if (!rows || rows.length === 0) return [];\r\n    const p = rows[0];\r\n\r\n    return [{\r\n      id_detail: p.id_pembayaran,\r\n      id_reservasi: p.id_reservasi,\r\n      metode_pembayaran: p.metode_pembayaran,\r\n      status_pembayaran: p.status_pembayaran,\r\n      bukti_pembayaran: p.bukti_pembayaran,\r\n      status_bukti: p.status_bukti,\r\n      catatan_admin: p.catatan_admin,\r\n      konfirmasi_admin: p.konfirmasi_admin,\r\n      created_at: p.created_at,\r\n      updated_at: p.updated_at\r\n    }];\r\n  }\r\n\r\n  // create detail = insert pembayaran\r\n  static async create(data) {\r\n    const insert = {\r\n      id_reservasi: data.id_reservasi,\r\n      metode_pembayaran: data.metode_pembayaran || 'transaksi',\r\n      status_pembayaran: data.status_pembayaran || 'unpaid',\r\n      bukti_pembayaran: data.bukti_pembayaran || null,\r\n      status_bukti: data.status_bukti || 'pending',\r\n      catatan_admin: data.catatan_admin || null,\r\n      konfirmasi_admin: data.konfirmasi_admin || false,\r\n      created_at: new Date(),\r\n      updated_at: new Date()\r\n    };\r\n    return Model_Pembayaran.Store(insert);\r\n  }\r\n\r\n  // updateByReservasi = update row pembayaran\r\n  static async updateByReservasi(id_reservasi, data) {\r\n    const rows = await Model_Pembayaran.getByReservasi(id_reservasi);\r\n    const mapped = {};\r\n\r\n    if (data.metode_pembayaran !== undefined) mapped.metode_pembayaran = data.metode_pembayaran;\r\n    if (data.status_pembayaran !== undefined) mapped.status_pembayaran = data.status_pembayaran;\r\n    if (data.bukti_pembayaran !== undefined) mapped.bukti_pembayaran = data.bukti_pembayaran;\r\n    if (data.status_bukti !== undefined) mapped.status_bukti = data.status_bukti;\r\n    if (data.catatan_admin !== undefined) mapped.catatan_admin = data.catatan_admin;\r\n    if (data.konfirmasi_admin !== undefined) mapped.konfirmasi_admin = data.konfirmasi_admin;\r\n    mapped.updated_at = new Date();\r\n\r\n    if (!rows || rows.length === 0) {\r\n      const insert = Object.assign({ id_reservasi, created_at: new Date() }, mapped);\r\n      return Model_Pembayaran.Store(insert);\r\n    } else {\r\n      return Model_Pembayaran.Update(rows[0].id_pembayaran, mapped);\r\n    }\r\n  }\r\n\r\n  // upsertBukti â†’ pakai uploadBuktiByReservasi\r\n  static async upsertBukti(id_reservasi, filename) {\r\n    return Model_Pembayaran.uploadBuktiByReservasi(id_reservasi, filename);\r\n  }\r\n}\r\n\r\nmodule.exports = Model_DetailPembayaran;\r\n"]}