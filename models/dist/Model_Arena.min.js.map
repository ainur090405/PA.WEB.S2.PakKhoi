{"version":3,"sources":["Model_Arena.js"],"names":["connection","require","Model_Arena","Promise","resolve","reject","query","err","rows","id","filter","params","sql","lokasi","push","jenis","id_arena","id_foto","result","Data","module","exports"],"mappings":"mZACA,IAAMA,WAAaC,QAAQ,sBAErBC,gOAIK,IAAIC,QAAQ,SAACC,EAASC,GAO3BL,WAAWM,MAdjB,iLAc4B,SAACC,EAAKC,GACtBD,EAAKF,EAAOE,GAAWH,EAAQI,4EAMpBC,4GACZ,IAAIN,QAAQ,SAACC,EAASC,GAPzBL,WAAAM,MAQO,4KARED,CAAAA,GAAOE,SAAAA,EAAhBC,GACDD,EAFDF,EAAAE,GAAAH,EAAAI,8EAsBmBE,4GACd,IAAIP,QAAQ,SAACC,EAASC,GAC3B,IAAIM,EAAS,GAlBjBC,EAAA,iLA0BQF,EAAOG,SACTD,GAAO,uBACPD,EAAOG,KAAK,IAAMJ,EAAOG,OAAS,MAnBpCb,EAAAA,QACEY,GAAA,4BACDD,EAAAG,KAFDJ,EAAAK,QAyBAH,GAAO,6BAEPZ,WAAWM,MAAMM,EAAKD,EAAQ,SAACJ,EAAKC,GAC9BD,EAAKF,EAAOE,GAAWH,EAAQI,2LAOhC,IAAIL,QAAQ,SAACC,EAASC,GAzB3BL,WAAAM,MA0BS,kOA1BF,SAAAC,EAAAC,GAkCDD,EAAKF,EAAOE,GAAWH,EAAQI,oMAtBnCI,IAAAA,QAAG,SAAIR,EAAAC,GAORL,WAFDM,MAJEK,8KAIF,SAAAJ,EAAAC,GAGDD,EA6BYF,EAAOE,GAAWH,EAAQI,6EAMnBQ,EAAUC,4GACtB,IAAId,QAAQ,SAACC,EAASC,GAjChCL,WAAAM,MAAA,wDAAA,CAAAW,EAAAD,GAAA,SAAAT,EAAAW,GAmCUX,EAAKF,EAAOE,GAAWH,EAAQc,0EAMtBC,4GACV,IAAIhB,QAAQ,SAACC,EAASC,GAC3BL,WAAWM,MAAM,0BAzCZa,EAAIhB,SAAAA,EAAQe,GACjBX,EAAAF,EAASE,GAAAH,EAAAc,2EA8COT,EAAIU,4GACf,IAAIhB,QAAQ,SAACC,EAASC,GAC3BL,WAAWM,MAAM,wCAAyC,CAACa,EAAMV,GAAK,SAACF,EAAKW,GACtEX,EAAKF,EAAOE,GAAWH,EAAQc,2EAKrBT,4GACX,IAAIN,QAAQ,SAACC,EAASC,GAC3BL,WAAWM,MAAM,uCAAwC,CAACG,GAAK,SAACF,EAAKW,GAC/DX,EAAKF,EAAOE,GAAWH,EAAQc,qDAzCrCE,OAAAC,QAAAnB","file":"Model_Arena.min.js","sourcesContent":["// models/Model_Arena.js\r\nconst connection = require('../config/database');\r\n\r\nclass Model_Arena {\r\n\r\n  // FUNGSI UPDATE: Ambil semua arena (termasuk foto cover)\r\n  static async getAll() {\r\n    return new Promise((resolve, reject) => {\r\n      const sql = `\r\n        SELECT a.*, f.url_foto AS foto_cover \r\n        FROM arena a\r\n        LEFT JOIN foto_arena f ON a.id_foto_cover = f.id_foto\r\n        ORDER BY a.id_arena DESC\r\n      `;\r\n      connection.query(sql, (err, rows) => {\r\n        if (err) reject(err); else resolve(rows);\r\n      });\r\n    });\r\n  }\r\n\r\n  // FUNGSI UPDATE: Ambil 1 arena (termasuk foto cover)\r\n  static async getById(id) {\r\n    return new Promise((resolve, reject) => {\r\n      const sql = `\r\n        SELECT a.*, f.url_foto AS foto_cover\r\n        FROM arena a\r\n        LEFT JOIN foto_arena f ON a.id_foto_cover = f.id_foto\r\n        WHERE a.id_arena = ?\r\n      `;\r\n      connection.query(sql, [id], (err, rows) => {\r\n        if (err) reject(err); else resolve(rows);\r\n      });\r\n    });\r\n  }\r\n\r\n  // FUNGSI UPDATE: Ambil arena untuk publik (termasuk foto cover)\r\n  static async getPublic(filter) {\r\n    return new Promise((resolve, reject) => {\r\n      let params = [];\r\n      let sql = `\r\n        SELECT a.*, f.url_foto AS foto_cover \r\n        FROM arena a\r\n        LEFT JOIN foto_arena f ON a.id_foto_cover = f.id_foto\r\n        WHERE a.status = 'aktif'\r\n      `;\r\n\r\n      if (filter.lokasi) {\r\n        sql += ' AND a.lokasi LIKE ?';\r\n        params.push('%' + filter.lokasi + '%');\r\n      }\r\n      if (filter.jenis) {\r\n        sql += ' AND a.jenis_olahraga = ?';\r\n        params.push(filter.jenis);\r\n      }\r\n      sql += ' ORDER BY a.nama_arena ASC';\r\n\r\n      connection.query(sql, params, (err, rows) => {\r\n        if (err) reject(err); else resolve(rows);\r\n      });\r\n    });\r\n  }\r\n\r\n  // FUNGSI UPDATE: Ambil arena untuk Home (termasuk foto cover)\r\n  static async getFeatured() {\r\n    return new Promise((resolve, reject) => {\r\n      const sql = `\r\n        SELECT a.*, f.url_foto AS foto_cover\r\n        FROM arena a \r\n        LEFT JOIN foto_arena f ON a.id_foto_cover = f.id_foto\r\n        WHERE a.status = 'aktif' AND a.id_foto_cover IS NOT NULL\r\n        LIMIT 3\r\n      `;\r\n      connection.query(sql, (err, rows) => {\r\n        if (err) reject(err); else resolve(rows);\r\n      });\r\n    });\r\n  }\r\n\r\n  // FUNGSI UPDATE: Ambil jenis olahraga unik (tidak berubah, tapi penting)\r\n  static async getJenisOlahragaList() {\r\n     return new Promise((resolve, reject) => {\r\n      const sql = `\r\n        SELECT DISTINCT jenis_olahraga \r\n        FROM arena \r\n        WHERE status = 'aktif' AND jenis_olahraga IS NOT NULL \r\n        ORDER BY jenis_olahraga ASC\r\n      `;\r\n      connection.query(sql, (err, rows) => {\r\n        if (err) reject(err); else resolve(rows);\r\n      });\r\n    });\r\n  }\r\n\r\n  // FUNGSI BARU: Untuk set foto cover\r\n  static async setCover(id_arena, id_foto) {\r\n     return new Promise((resolve, reject) => {\r\n      connection.query('UPDATE arena SET id_foto_cover = ? WHERE id_arena = ?', [id_foto, id_arena], (err, result) => {\r\n        if (err) reject(err); else resolve(result);\r\n      });\r\n    });\r\n  }\r\n  \r\n  // --- Fungsi CRUD (tidak berubah) ---\r\n  static async Store(Data) {\r\n    return new Promise((resolve, reject) => {\r\n      connection.query('INSERT INTO arena SET ?', Data, (err, result) => {\r\n        if (err) reject(err); else resolve(result);\r\n      });\r\n    });\r\n  }\r\n\r\n  static async Update(id, Data) {\r\n    return new Promise((resolve, reject) => {\r\n      connection.query('UPDATE arena SET ? WHERE id_arena = ?', [Data, id], (err, result) => {\r\n        if (err) reject(err); else resolve(result);\r\n      });\r\n    });\r\n  }\r\n\r\n  static async Delete(id) {\r\n    return new Promise((resolve, reject) => {\r\n      connection.query('DELETE FROM arena WHERE id_arena = ?', [id], (err, result) => {\r\n        if (err) reject(err); else resolve(result);\r\n      });\r\n    });\r\n  }\r\n}\r\n\r\nmodule.exports = Model_Arena;"]}