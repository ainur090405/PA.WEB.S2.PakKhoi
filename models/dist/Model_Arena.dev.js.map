{"version":3,"sources":["Model_Arena.js"],"names":["connection","require","Model_Arena","Promise","resolve","reject","sql","query","err","rows","id","filter","params","lokasi","push","jenis","id_arena","id_foto","result","Data","module","exports"],"mappings":";;;;;;;;AAAA;AACA,IAAMA,UAAU,GAAGC,OAAO,CAAC,oBAAD,CAA1B;;IAEMC,W;;;;;;;;;AAEJ;;;;;;+CAES,IAAIC,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;AACtC,oBAAMC,GAAG,mLAAT;AAMAN,gBAAAA,UAAU,CAACO,KAAX,CAAiBD,GAAjB,EAAsB,UAACE,GAAD,EAAMC,IAAN,EAAe;AACnC,sBAAID,GAAJ,EAASH,MAAM,CAACG,GAAD,CAAN,CAAT,KAA2BJ,OAAO,CAACK,IAAD,CAAP;AAC5B,iBAFD;AAGD,eAVM,C;;;;;;;;MAaT;;;;4BACqBC,E;;;;;gDACZ,IAAIP,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;AACtC,oBAAMC,GAAG,8KAAT;AAMAN,gBAAAA,UAAU,CAACO,KAAX,CAAiBD,GAAjB,EAAsB,CAACI,EAAD,CAAtB,EAA4B,UAACF,GAAD,EAAMC,IAAN,EAAe;AACzC,sBAAID,GAAJ,EAASH,MAAM,CAACG,GAAD,CAAN,CAAT,KAA2BJ,OAAO,CAACK,IAAD,CAAP;AAC5B,iBAFD;AAGD,eAVM,C;;;;;;;;MAaT;;;;8BACuBE,M;;;;;gDACd,IAAIR,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;AACtC,oBAAIO,MAAM,GAAG,EAAb;AACA,oBAAIN,GAAG,mLAAP;;AAOA,oBAAIK,MAAM,CAACE,MAAX,EAAmB;AACjBP,kBAAAA,GAAG,IAAI,sBAAP;AACAM,kBAAAA,MAAM,CAACE,IAAP,CAAY,MAAMH,MAAM,CAACE,MAAb,GAAsB,GAAlC;AACD;;AACD,oBAAIF,MAAM,CAACI,KAAX,EAAkB;AAChBT,kBAAAA,GAAG,IAAI,2BAAP;AACAM,kBAAAA,MAAM,CAACE,IAAP,CAAYH,MAAM,CAACI,KAAnB;AACD;;AACDT,gBAAAA,GAAG,IAAI,4BAAP;AAEAN,gBAAAA,UAAU,CAACO,KAAX,CAAiBD,GAAjB,EAAsBM,MAAtB,EAA8B,UAACJ,GAAD,EAAMC,IAAN,EAAe;AAC3C,sBAAID,GAAJ,EAASH,MAAM,CAACG,GAAD,CAAN,CAAT,KAA2BJ,OAAO,CAACK,IAAD,CAAP;AAC5B,iBAFD;AAGD,eAtBM,C;;;;;;;;MAyBT;;;;;;;;;gDAES,IAAIN,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;AACtC,oBAAMC,GAAG,oOAAT;AAOAN,gBAAAA,UAAU,CAACO,KAAX,CAAiBD,GAAjB,EAAsB,UAACE,GAAD,EAAMC,IAAN,EAAe;AACnC,sBAAID,GAAJ,EAASH,MAAM,CAACG,GAAD,CAAN,CAAT,KAA2BJ,OAAO,CAACK,IAAD,CAAP;AAC5B,iBAFD;AAGD,eAXM,C;;;;;;;;MAcT;;;;;;;;;gDAEU,IAAIN,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;AACvC,oBAAMC,GAAG,gLAAT;AAMAN,gBAAAA,UAAU,CAACO,KAAX,CAAiBD,GAAjB,EAAsB,UAACE,GAAD,EAAMC,IAAN,EAAe;AACnC,sBAAID,GAAJ,EAASH,MAAM,CAACG,GAAD,CAAN,CAAT,KAA2BJ,OAAO,CAACK,IAAD,CAAP;AAC5B,iBAFD;AAGD,eAVO,C;;;;;;;;MAaV;;;;6BACsBO,Q,EAAUC,O;;;;;gDACtB,IAAId,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;AACvCL,gBAAAA,UAAU,CAACO,KAAX,CAAiB,uDAAjB,EAA0E,CAACU,OAAD,EAAUD,QAAV,CAA1E,EAA+F,UAACR,GAAD,EAAMU,MAAN,EAAiB;AAC9G,sBAAIV,GAAJ,EAASH,MAAM,CAACG,GAAD,CAAN,CAAT,KAA2BJ,OAAO,CAACc,MAAD,CAAP;AAC5B,iBAFD;AAGD,eAJO,C;;;;;;;;MAOV;;;;0BACmBC,I;;;;;gDACV,IAAIhB,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;AACtCL,gBAAAA,UAAU,CAACO,KAAX,CAAiB,yBAAjB,EAA4CY,IAA5C,EAAkD,UAACX,GAAD,EAAMU,MAAN,EAAiB;AACjE,sBAAIV,GAAJ,EAASH,MAAM,CAACG,GAAD,CAAN,CAAT,KAA2BJ,OAAO,CAACc,MAAD,CAAP;AAC5B,iBAFD;AAGD,eAJM,C;;;;;;;;;;;2BAOWR,E,EAAIS,I;;;;;gDACf,IAAIhB,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;AACtCL,gBAAAA,UAAU,CAACO,KAAX,CAAiB,uCAAjB,EAA0D,CAACY,IAAD,EAAOT,EAAP,CAA1D,EAAsE,UAACF,GAAD,EAAMU,MAAN,EAAiB;AACrF,sBAAIV,GAAJ,EAASH,MAAM,CAACG,GAAD,CAAN,CAAT,KAA2BJ,OAAO,CAACc,MAAD,CAAP;AAC5B,iBAFD;AAGD,eAJM,C;;;;;;;;;;;2BAOWR,E;;;;;gDACX,IAAIP,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;AACtCL,gBAAAA,UAAU,CAACO,KAAX,CAAiB,sCAAjB,EAAyD,CAACG,EAAD,CAAzD,EAA+D,UAACF,GAAD,EAAMU,MAAN,EAAiB;AAC9E,sBAAIV,GAAJ,EAASH,MAAM,CAACG,GAAD,CAAN,CAAT,KAA2BJ,OAAO,CAACc,MAAD,CAAP;AAC5B,iBAFD;AAGD,eAJM,C;;;;;;;;;;;;;;AAQXE,MAAM,CAACC,OAAP,GAAiBnB,WAAjB","sourcesContent":["// models/Model_Arena.js\r\nconst connection = require('../config/database');\r\n\r\nclass Model_Arena {\r\n\r\n  // FUNGSI UPDATE: Ambil semua arena (termasuk foto cover)\r\n  static async getAll() {\r\n    return new Promise((resolve, reject) => {\r\n      const sql = `\r\n        SELECT a.*, f.url_foto AS foto_cover \r\n        FROM arena a\r\n        LEFT JOIN foto_arena f ON a.id_foto_cover = f.id_foto\r\n        ORDER BY a.id_arena DESC\r\n      `;\r\n      connection.query(sql, (err, rows) => {\r\n        if (err) reject(err); else resolve(rows);\r\n      });\r\n    });\r\n  }\r\n\r\n  // FUNGSI UPDATE: Ambil 1 arena (termasuk foto cover)\r\n  static async getById(id) {\r\n    return new Promise((resolve, reject) => {\r\n      const sql = `\r\n        SELECT a.*, f.url_foto AS foto_cover\r\n        FROM arena a\r\n        LEFT JOIN foto_arena f ON a.id_foto_cover = f.id_foto\r\n        WHERE a.id_arena = ?\r\n      `;\r\n      connection.query(sql, [id], (err, rows) => {\r\n        if (err) reject(err); else resolve(rows);\r\n      });\r\n    });\r\n  }\r\n\r\n  // FUNGSI UPDATE: Ambil arena untuk publik (termasuk foto cover)\r\n  static async getPublic(filter) {\r\n    return new Promise((resolve, reject) => {\r\n      let params = [];\r\n      let sql = `\r\n        SELECT a.*, f.url_foto AS foto_cover \r\n        FROM arena a\r\n        LEFT JOIN foto_arena f ON a.id_foto_cover = f.id_foto\r\n        WHERE a.status = 'aktif'\r\n      `;\r\n\r\n      if (filter.lokasi) {\r\n        sql += ' AND a.lokasi LIKE ?';\r\n        params.push('%' + filter.lokasi + '%');\r\n      }\r\n      if (filter.jenis) {\r\n        sql += ' AND a.jenis_olahraga = ?';\r\n        params.push(filter.jenis);\r\n      }\r\n      sql += ' ORDER BY a.nama_arena ASC';\r\n\r\n      connection.query(sql, params, (err, rows) => {\r\n        if (err) reject(err); else resolve(rows);\r\n      });\r\n    });\r\n  }\r\n\r\n  // FUNGSI UPDATE: Ambil arena untuk Home (termasuk foto cover)\r\n  static async getFeatured() {\r\n    return new Promise((resolve, reject) => {\r\n      const sql = `\r\n        SELECT a.*, f.url_foto AS foto_cover\r\n        FROM arena a \r\n        LEFT JOIN foto_arena f ON a.id_foto_cover = f.id_foto\r\n        WHERE a.status = 'aktif' AND a.id_foto_cover IS NOT NULL\r\n        LIMIT 3\r\n      `;\r\n      connection.query(sql, (err, rows) => {\r\n        if (err) reject(err); else resolve(rows);\r\n      });\r\n    });\r\n  }\r\n\r\n  // FUNGSI UPDATE: Ambil jenis olahraga unik (tidak berubah, tapi penting)\r\n  static async getJenisOlahragaList() {\r\n     return new Promise((resolve, reject) => {\r\n      const sql = `\r\n        SELECT DISTINCT jenis_olahraga \r\n        FROM arena \r\n        WHERE status = 'aktif' AND jenis_olahraga IS NOT NULL \r\n        ORDER BY jenis_olahraga ASC\r\n      `;\r\n      connection.query(sql, (err, rows) => {\r\n        if (err) reject(err); else resolve(rows);\r\n      });\r\n    });\r\n  }\r\n\r\n  // FUNGSI BARU: Untuk set foto cover\r\n  static async setCover(id_arena, id_foto) {\r\n     return new Promise((resolve, reject) => {\r\n      connection.query('UPDATE arena SET id_foto_cover = ? WHERE id_arena = ?', [id_foto, id_arena], (err, result) => {\r\n        if (err) reject(err); else resolve(result);\r\n      });\r\n    });\r\n  }\r\n  \r\n  // --- Fungsi CRUD (tidak berubah) ---\r\n  static async Store(Data) {\r\n    return new Promise((resolve, reject) => {\r\n      connection.query('INSERT INTO arena SET ?', Data, (err, result) => {\r\n        if (err) reject(err); else resolve(result);\r\n      });\r\n    });\r\n  }\r\n\r\n  static async Update(id, Data) {\r\n    return new Promise((resolve, reject) => {\r\n      connection.query('UPDATE arena SET ? WHERE id_arena = ?', [Data, id], (err, result) => {\r\n        if (err) reject(err); else resolve(result);\r\n      });\r\n    });\r\n  }\r\n\r\n  static async Delete(id) {\r\n    return new Promise((resolve, reject) => {\r\n      connection.query('DELETE FROM arena WHERE id_arena = ?', [id], (err, result) => {\r\n        if (err) reject(err); else resolve(result);\r\n      });\r\n    });\r\n  }\r\n}\r\n\r\nmodule.exports = Model_Arena;"],"file":"Model_Arena.dev.js"}