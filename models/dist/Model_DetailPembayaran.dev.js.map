{"version":3,"sources":["Model_DetailPembayaran.js"],"names":["Model_Pembayaran","require","Model_DetailPembayaran","id_reservasi","getByReservasi","rows","length","p","id_detail","id_pembayaran","metode_pembayaran","status_pembayaran","bukti_pembayaran","status_bukti","catatan_admin","konfirmasi_admin","created_at","updated_at","data","insert","Date","Store","mapped","undefined","Object","assign","Update","filename","uploadBuktiByReservasi","module","exports"],"mappings":"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","sourcesContent":["const Model_Pembayaran = require('./Model_Pembayaran');\r\n\r\nclass Model_DetailPembayaran {\r\n\r\n  // Kembalikan \"detail\" berdasarkan id_reservasi\r\n  // Format array 1 elemen, mirip hasil query dulu.\r\n  static async getByReservasi(id_reservasi) {\r\n    const rows = await Model_Pembayaran.getByReservasi(id_reservasi);\r\n    if (!rows || rows.length === 0) return [];\r\n    const p = rows[0];\r\n\r\n    return [{\r\n      id_detail: p.id_pembayaran,\r\n      id_reservasi: p.id_reservasi,\r\n      metode_pembayaran: p.metode_pembayaran,\r\n      status_pembayaran: p.status_pembayaran,\r\n      bukti_pembayaran: p.bukti_pembayaran,\r\n      status_bukti: p.status_bukti,\r\n      catatan_admin: p.catatan_admin,\r\n      konfirmasi_admin: p.konfirmasi_admin,\r\n      created_at: p.created_at,\r\n      updated_at: p.updated_at\r\n    }];\r\n  }\r\n\r\n  // create detail = insert pembayaran\r\n  static async create(data) {\r\n    const insert = {\r\n      id_reservasi: data.id_reservasi,\r\n      metode_pembayaran: data.metode_pembayaran || 'transaksi',\r\n      status_pembayaran: data.status_pembayaran || 'unpaid',\r\n      bukti_pembayaran: data.bukti_pembayaran || null,\r\n      status_bukti: data.status_bukti || 'pending',\r\n      catatan_admin: data.catatan_admin || null,\r\n      konfirmasi_admin: data.konfirmasi_admin || false,\r\n      created_at: new Date(),\r\n      updated_at: new Date()\r\n    };\r\n    return Model_Pembayaran.Store(insert);\r\n  }\r\n\r\n  // updateByReservasi = update row pembayaran\r\n  static async updateByReservasi(id_reservasi, data) {\r\n    const rows = await Model_Pembayaran.getByReservasi(id_reservasi);\r\n    const mapped = {};\r\n\r\n    if (data.metode_pembayaran !== undefined) mapped.metode_pembayaran = data.metode_pembayaran;\r\n    if (data.status_pembayaran !== undefined) mapped.status_pembayaran = data.status_pembayaran;\r\n    if (data.bukti_pembayaran !== undefined) mapped.bukti_pembayaran = data.bukti_pembayaran;\r\n    if (data.status_bukti !== undefined) mapped.status_bukti = data.status_bukti;\r\n    if (data.catatan_admin !== undefined) mapped.catatan_admin = data.catatan_admin;\r\n    if (data.konfirmasi_admin !== undefined) mapped.konfirmasi_admin = data.konfirmasi_admin;\r\n    mapped.updated_at = new Date();\r\n\r\n    if (!rows || rows.length === 0) {\r\n      const insert = Object.assign({ id_reservasi, created_at: new Date() }, mapped);\r\n      return Model_Pembayaran.Store(insert);\r\n    } else {\r\n      return Model_Pembayaran.Update(rows[0].id_pembayaran, mapped);\r\n    }\r\n  }\r\n\r\n  // upsertBukti â†’ pakai uploadBuktiByReservasi\r\n  static async upsertBukti(id_reservasi, filename) {\r\n    return Model_Pembayaran.uploadBuktiByReservasi(id_reservasi, filename);\r\n  }\r\n}\r\n\r\nmodule.exports = Model_DetailPembayaran;\r\n"],"file":"Model_DetailPembayaran.dev.js"}