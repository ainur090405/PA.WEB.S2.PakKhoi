{"version":3,"sources":["Model_Jadwal.js"],"names":["connection","require","Model_Jadwal","Promise","resolve","reject","query","err","rows","id","sql","id_arena","sesiData","values","map","sesi","tanggal","jam_mulai","jam_selesai","status_slot","result","Data","id_jadwal","data","module","exports"],"mappings":"mZACA,IAAMA,WAAaC,QAAQ,sBAErBC,iOAIK,IAAIC,QAAQ,SAACC,EAASC,GAO3BL,WAAWM,MAdjB,wKAc4B,SAACC,EAAKC,GACtBD,EAAKF,EAAOE,GAAWH,EAAQI,4EAItBC,4GAdnB,IAAAN,QAAA,SAAAC,EAAAC,GAGIL,WAAAM,MAaS,8KAbA,CAAAG,GAAA,SAAAF,EAAAC,GAMTR,EAAAA,EAAAA,GAAiBU,EAAKF,0FAmBSG,4GAC1B,IAAIR,QAAQ,SAACC,EAASC,GAU3BL,WAAWM,MATF,sSASa,CAACK,GAAW,SAACJ,EAAKC,GAClCD,EAAKF,EAAOE,GAAWH,EAAQI,8EAjBnCI,4GACD,IAAAT,QAFD,SAAAC,EAAAC,GA0BA,IAAMQ,EAASD,EAASE,IAAI,SAAAC,GAAI,MAAI,CAClCA,EAAKJ,SACLI,EAAKC,QACLD,EAAKE,UACLF,EAAKG,YACLH,EAAKI,eAMPnB,WAAWM,MAFC,uFAEU,CAACO,GAAS,SAACN,EA/BFI,GAgCzBJ,EAAKF,EAAOE,GACXH,EAAQgB,0EAtBfpB,4GACE,IAAAG,QAAII,SAAAA,EAAWF,GAChBL,WAFDM,MAAA,2BAAAe,EAAA,SAAAd,EAAAa,GAGDb,EA2BYF,EAAOE,GAAWH,EAAQgB,2EAIvBE,EAAWC,4GACtB,IAAIpB,QAAQ,SAACC,EAASC,GAE3BL,WAAWM,MADC,0CACU,CAACiB,EAAMD,GAAY,SAACf,EAAKa,GAhCjDb,EAAAF,EAAAE,GAkCSH,EAAQgB,2EAOGX,4GACX,IAAIN,QAAQ,SAACC,EAASC,GAvC3BL,WAAAM,MAAA,yCAAA,CAAAG,GAAA,SAAAF,EAAAa,GACAb,EAAAF,EAAMQ,GAASD,EAAaQ,qDAY1BI,OAAAC,QAAAvB","file":"Model_Jadwal.min.js","sourcesContent":["// models/Model_Jadwal.js\r\nconst connection = require('../config/database');\r\n\r\nclass Model_Jadwal {\r\n\r\n  // FUNGSI BARU: Ambil semua jadwal (JOIN dengan arena)\r\n  static async getAll() {\r\n    return new Promise((resolve, reject) => {\r\n      const sql = `\r\n        SELECT j.*, a.nama_arena \r\n        FROM jadwal j\r\n        JOIN arena a ON j.id_arena = a.id_arena\r\n        ORDER BY j.tanggal DESC, j.jam_mulai ASC\r\n      `;\r\n      connection.query(sql, (err, rows) => {\r\n        if (err) reject(err); else resolve(rows);\r\n      });\r\n    });\r\n  }\r\nstatic async getById(id) {\r\n    return new Promise((resolve, reject) => {\r\n      const sql = `\r\n        SELECT j.*, a.nama_arena, a.jam_buka, a.jam_tutup \r\n        FROM jadwal j\r\n        JOIN arena a ON j.id_arena = a.id_arena\r\n        WHERE j.id_jadwal = ?\r\n      `;\r\n      connection.query(sql, [id], (err, rows) => {\r\n        if (err) reject(err); else resolve(rows);\r\n      });\r\n    });\r\n  }\r\n  // FUNGSI BARU: Ambil semua jadwal masa depan untuk 1 arena (termasuk yang sudah terisi, untuk tampilan)\r\n  static async getAvailableByArenaId(id_arena) {\r\n    return new Promise((resolve, reject) => {\r\n      const sql = `\r\n        SELECT * FROM jadwal\r\n        WHERE id_arena = ?\r\n          AND (\r\n            tanggal > CURDATE()  -- Hari mendatang\r\n            OR (tanggal = CURDATE() AND jam_mulai > CURTIME())  -- Hari ini tapi jam belum lewat\r\n          )\r\n        ORDER BY tanggal ASC, jam_mulai ASC\r\n      `;\r\n      connection.query(sql, [id_arena], (err, rows) => {\r\n        if (err) reject(err); else resolve(rows);\r\n      });\r\n    });\r\n  }\r\n  // FUNGSI BARU UNTUK GENERATOR\r\n  static async StoreMany(sesiData) {\r\n    return new Promise((resolve, reject) => {\r\n      // 1. Ubah array of objects [{}, {}] menjadi array of arrays [[], []]\r\n      const values = sesiData.map(sesi => [\r\n        sesi.id_arena,\r\n        sesi.tanggal,\r\n        sesi.jam_mulai,\r\n        sesi.jam_selesai,\r\n        sesi.status_slot\r\n      ]);\r\n\r\n      // 2. Query SQL untuk bulk insert (menyimpan banyak data sekaligus)\r\n      const sql = 'INSERT INTO jadwal (id_arena, tanggal, jam_mulai, jam_selesai, status_slot) VALUES ?';\r\n      \r\n      connection.query(sql, [values], (err, result) => {\r\n        if (err) reject(err);\r\n        else resolve(result);\r\n      });\r\n    });\r\n  }\r\n  // FUNGSI BARU: Simpan jadwal baru\r\n  static async Store(Data) {\r\n    return new Promise((resolve, reject) => {\r\n      connection.query('INSERT INTO jadwal SET ?', Data, (err, result) => {\r\n        if (err) reject(err); else resolve(result);\r\n      });\r\n    });\r\n  }\r\nstatic async Update(id_jadwal, data) {\r\n  return new Promise((resolve, reject) => {\r\n    const sql = 'UPDATE jadwal SET ? WHERE id_jadwal = ?';\r\n    connection.query(sql, [data, id_jadwal], (err, result) => {\r\n      if (err) reject(err);\r\n      else resolve(result);\r\n    });\r\n  });\r\n}\r\n\r\n\r\n  // FUNGSI BARU: Hapus jadwal\r\n  static async Delete(id) {\r\n    return new Promise((resolve, reject) => {\r\n      connection.query('DELETE FROM jadwal WHERE id_jadwal = ?', [id], (err, result) => {\r\n        if (err) reject(err); else resolve(result);\r\n      });\r\n    });\r\n  }\r\n}\r\n\r\nmodule.exports = Model_Jadwal;"]}