"use strict";function _classCallCheck(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(n,e){for(var a=0;a<e.length;a++){var r=e[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(n,r.key,r)}}function _createClass(n,e,a){return e&&_defineProperties(n.prototype,e),a&&_defineProperties(n,a),n}var connection=require("../config/database"),Model_Jadwal=function(){function n(){_classCallCheck(this,n)}return _createClass(n,null,[{key:"getAll",value:function(){return regeneratorRuntime.async(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",new Promise(function(a,r){connection.query("\n        SELECT j.*, a.nama_arena \n        FROM jadwal j\n        JOIN arena a ON j.id_arena = a.id_arena\n        ORDER BY j.tanggal DESC, j.jam_mulai ASC\n      ",function(n,e){n?r(n):a(e)})}));case 1:case"end":return n.stop()}})}},{key:"getById",value:function(e){return regeneratorRuntime.async(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",new Promise(function(a,r){connection.query("\n        SELECT j.*, a.nama_arena, a.jam_buka, a.jam_tutup \n        FROM jadwal j\n        JOIN arena a ON j.id_arena = a.id_arena\n        WHERE j.id_jadwal = ?\n      ",[e],function(n,e){n?r(n):a(e)})}));case 1:case"end":return n.stop()}})}},{key:"getAvailableByArenaId",value:function(e){return regeneratorRuntime.async(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",new Promise(function(a,r){connection.query("\n        SELECT * FROM jadwal\n        WHERE id_arena = ?\n          AND (\n            tanggal > CURDATE()  -- Hari mendatang\n            OR (tanggal = CURDATE() AND jam_mulai > CURTIME())  -- Hari ini tapi jam belum lewat\n          )\n        ORDER BY tanggal ASC, jam_mulai ASC\n      ",[e],function(n,e){n?r(n):a(e)})}));case 1:case"end":return n.stop()}})}},{key:"StoreMany",value:function(e){return regeneratorRuntime.async(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",new Promise(function(a,r){var n=e.map(function(n){return[n.id_arena,n.tanggal,n.jam_mulai,n.jam_selesai,n.status_slot]});connection.query("INSERT INTO jadwal (id_arena, tanggal, jam_mulai, jam_selesai, status_slot) VALUES ?",[n],function(n,e){n?r(n):a(e)})}));case 1:case"end":return n.stop()}})}},{key:"Store",value:function(e){return regeneratorRuntime.async(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",new Promise(function(a,r){connection.query("INSERT INTO jadwal SET ?",e,function(n,e){n?r(n):a(e)})}));case 1:case"end":return n.stop()}})}},{key:"Update",value:function(e,t){return regeneratorRuntime.async(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",new Promise(function(a,r){connection.query("UPDATE jadwal SET ? WHERE id_jadwal = ?",[t,e],function(n,e){n?r(n):a(e)})}));case 1:case"end":return n.stop()}})}},{key:"Delete",value:function(e){return regeneratorRuntime.async(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",new Promise(function(a,r){connection.query("DELETE FROM jadwal WHERE id_jadwal = ?",[e],function(n,e){n?r(n):a(e)})}));case 1:case"end":return n.stop()}})}}]),n}();module.exports=Model_Jadwal;
//# sourceMappingURL=Model_Jadwal.min.js.map
