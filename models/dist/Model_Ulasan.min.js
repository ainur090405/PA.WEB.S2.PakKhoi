"use strict";function _classCallCheck(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,n){for(var r=0;r<n.length;r++){var t=n[r];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}function _createClass(e,n,r){return n&&_defineProperties(e.prototype,n),r&&_defineProperties(e,r),e}var connection=require("../config/database"),Model_Ulasan=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"getByUser",value:function(n){return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(r,t){connection.query("\n        SELECT u.rating, u.komentar, u.tanggal_ulasan, a.nama_arena\n        FROM ulasan u\n        JOIN reservasi r ON u.id_reservasi = r.id_reservasi\n        JOIN arena a ON r.id_arena = a.id_arena\n        WHERE u.id_user = ?\n        ORDER BY u.tanggal_ulasan DESC\n      ",[n],function(e,n){e?t(e):r(n)})}));case 1:case"end":return e.stop()}})}},{key:"getAll",value:function(){return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(r,t){connection.query("SELECT * FROM ulasan",function(e,n){e?t(e):r(n)})}));case 1:case"end":return e.stop()}})}},{key:"getById",value:function(n){return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(r,t){connection.query("SELECT * FROM ulasan WHERE id_ulasan = ?",[n],function(e,n){e?t(e):r(n)})}));case 1:case"end":return e.stop()}})}},{key:"getByReservasi",value:function(n){return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(r,t){connection.query("SELECT * FROM ulasan WHERE id_reservasi = ?",[n],function(e,n){e?t(e):r(n)})}));case 1:case"end":return e.stop()}})}},{key:"Store",value:function(n){return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(r,t){connection.query("INSERT INTO ulasan SET ?",n,function(e,n){e?t(e):r(n)})}));case 1:case"end":return e.stop()}})}},{key:"Update",value:function(n,a){return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(r,t){connection.query("UPDATE ulasan SET ? WHERE id_reservasi = ?",[a,n],function(e,n){e?t(e):r(n)})}));case 1:case"end":return e.stop()}})}},{key:"Delete",value:function(n){return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(r,t){connection.query("DELETE FROM ulasan WHERE id_reservasi = ?",[n],function(e,n){e?t(e):r(n)})}));case 1:case"end":return e.stop()}})}},{key:"getByArena",value:function(n){return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(r,t){connection.query("\n        SELECT u.rating, u.komentar, u.tanggal_ulasan, usr.nama as nama_user\n        FROM ulasan u\n        JOIN reservasi r ON u.id_reservasi = r.id_reservasi\n        JOIN users usr ON u.id_user = usr.id_user\n        WHERE r.id_arena = ?\n        ORDER BY u.tanggal_ulasan DESC\n      ",[n],function(e,n){e?t(e):r(n)})}));case 1:case"end":return e.stop()}})}},{key:"UpdateByReservasi",value:function(n,a){return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(r,t){connection.query("UPDATE ulasan SET ? WHERE id_reservasi = ?",[a,n],function(e,n){e?t(e):r(n)})}));case 1:case"end":return e.stop()}})}},{key:"getAverageRating",value:function(n){return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(r,t){connection.query("\n        SELECT AVG(u.rating) as avg_rating, COUNT(u.id_ulasan) as total_reviews\n        FROM ulasan u\n        JOIN reservasi r ON u.id_reservasi = r.id_reservasi\n        WHERE r.id_arena = ?\n      ",[n],function(e,n){e?t(e):r(n[0])})}));case 1:case"end":return e.stop()}})}}]),e}();module.exports=Model_Ulasan;
//# sourceMappingURL=Model_Ulasan.min.js.map
