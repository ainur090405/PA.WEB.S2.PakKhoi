{"version":3,"sources":["notifikasi.js"],"names":["express","require","router","Router","isAuthenticated","Model_Notifikasi","req","res","id_user","notifications","unreadCount","regeneratorRuntime","async","_context","prev","next","session","user","id","awrap","getByUser","sent","getUnreadCount","json","t0","console","error","status","stop","id_notifikasi","_context2","params","markAsRead","success","_context3","markAllAsRead"],"mappings":"aAAA,IAAMA,QAAUC,QAAQ,WAClBC,OAASF,QAAQG,SADjBH,iBAAkBC,QAAxB,uCAG4BA,QAAQ,gCAA5BG,yBAAAA,gBADRF,OAAMG,IAAAA,OAAAA,gBAA2B,SAAAC,EAAAC,GAAA,IAAAC,EAAAC,EAAAC,EAAA,OAAAC,mBAAAC,MAAA,SAAAC,GAAA,OAAA,OAAAA,EAAAC,KAAAD,EAAAE,MAAA,KAAA,EAAA,OAAAF,EAAAC,KAAA,EAMvBN,EALkBP,EAAQe,QAAAC,KAAAC,GADHL,EAAAE,KAAA,EAAAJ,mBAAAQ,MACzBf,iBAERgB,UAAAZ,IAHiC,KAAA,EAAA,OACzBJ,EADyBS,EAAAQ,KAAAR,EAAAE,KAAA,EAAAJ,mBAAAQ,MAQHd,iBAAiBiB,eAAed,IAR7B,KAAA,EAQvBE,EARuBG,EAAAQ,KAS7Bd,EAAIgB,KAAK,CAAEd,cAAAA,EAAeC,YAAAA,IATGG,EAAAE,KAAA,GAAA,MAAA,KAAA,GAAAF,EAAAC,KAAA,GAAAD,EAAAW,GAAAX,EAAA,MAAA,GAIGY,QAAAC,MAAAb,EAAAW,IAAAjB,EAAAoB,OAAA,KAAAJ,KAAA,CAAAG,MAAA,+BAJH,KAAA,GAAA,IAAA,MAAA,OAAAb,EAAAe,SAAA,KAAA,KAAA,CAAA,CAAA,EAAA,QAMvBpB,OAAAA,KAAAA,iBAAcQ,gBAFY,SAAAV,EAAAC,GAAA,IAAAsB,EAAA,OAAAlB,mBAAAC,MAAA,SAAAkB,GAAA,OAAA,OAAAA,EAAAhB,KAAAgB,EAAAf,MAAA,KAAA,EAAA,OAAAe,EAAAhB,KAAA,EAAAe,EAAAvB,EAAAyB,OAAAb,GAAAY,EAAAf,KAAA,EAAAJ,mBAAAQ,MAgB1Bd,iBAAiB2B,WAAWH,IAhBF,KAAA,EAAAtB,EAAAgB,KAAA,CAAAU,SAAA,IAAAH,EAAAf,KAAA,GAAA,MAAA,KAAA,EAAAe,EAAAhB,KAAA,EAAAgB,EAAAN,GAAAM,EAAA,MAAA,GAAAL,QAAAC,MAAAI,EAAAN,IAAAjB,EAAAoB,OAAA,KAAAJ,KAAA,CAAAG,MAAA,8BAAA,KAAA,GAAA,IAAA,MAAA,OAAAI,EAAAF,SAAA,KAAA,KAAA,CAAA,CAAA,EAAA,OAKrBnB,OAAAA,KAAAA,iBAAAA,gBAAF,SAAAH,EAAAC,GAAA,IAAAC,EAAA,OAAAG,mBAAAC,MAAA,SAAAsB,GAAA,OAAA,OAAAA,EAAApB,KAAAoB,EAAAnB,MAAA,KAAA,EAAA,OAAAmB,EAAApB,KAAA,EAAAN,EAATF,EAAAU,QAAAC,KAAAC,GAASgB,EAAAnB,KAAA,EAAAJ,mBAAAQ,MALuBd,iBAAA8B,cAAA3B,IAKvB,KAAA,EALuBD,EAAAgB,KAAA,CAAAU,SAAA,IAKvBC,EAAAnB,KAAA,GAAA,MAAA,KAAA,EAAAmB,EAAApB,KAAA,EAAAoB,EAAAV,GAAAU,EAAA,MAAA,GALuBT,QAAAC,MAAAQ,EAAAV,IAAAjB,EAAAoB,OAAA,KAAAJ,KAAA,CAAAG,MAAA,oCAKvB,KAAA,GAAA,IAAA,MAAA,OAAAQ,EAAAN,SAAA,KAAA,KAAA,CAAA,CAAA,EAAA,OAGcF,OAAAA,QAAKxB","file":"notifikasi.min.js","sourcesContent":["const express = require('express');\r\nconst router = express.Router();\r\nconst Model_Notifikasi = require('../models/Model_Notifikasi');\r\nconst { isAuthenticated } = require('../middleware/authMiddleware');\r\n\r\n// GET: Ambil notifikasi user (untuk AJAX)\r\nrouter.get('/get', isAuthenticated, async (req, res) => {\r\n  try {\r\n    const id_user = req.session.user.id;\r\n    const notifications = await Model_Notifikasi.getByUser(id_user);\r\n    const unreadCount = await Model_Notifikasi.getUnreadCount(id_user);\r\n    res.json({ notifications, unreadCount });\r\n  } catch (err) {\r\n    console.error(err);\r\n    res.status(500).json({ error: 'Gagal mengambil notifikasi' });\r\n  }\r\n});\r\n\r\n// POST: Tandai notifikasi sebagai dibaca\r\nrouter.post('/mark-read/:id', isAuthenticated, async (req, res) => {\r\n  try {\r\n    const id_notifikasi = req.params.id;\r\n    await Model_Notifikasi.markAsRead(id_notifikasi);\r\n    res.json({ success: true });\r\n  } catch (err) {\r\n    console.error(err);\r\n    res.status(500).json({ error: 'Gagal menandai notifikasi' });\r\n  }\r\n});\r\n\r\n// POST: Tandai semua notifikasi sebagai dibaca\r\nrouter.post('/mark-all-read', isAuthenticated, async (req, res) => {\r\n  try {\r\n    const id_user = req.session.user.id;\r\n    await Model_Notifikasi.markAllAsRead(id_user);\r\n    res.json({ success: true });\r\n  } catch (err) {\r\n    console.error(err);\r\n    res.status(500).json({ error: 'Gagal menandai semua notifikasi' });\r\n  }\r\n});\r\n\r\nmodule.exports = router;\r\n"]}