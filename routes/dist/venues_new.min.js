"use strict";function _slicedToArray(e,r){return _arrayWithHoles(e)||_iterableToArrayLimit(e,r)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(e,r){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)){var a=[],t=!0,n=!1,l=void 0;try{for(var o,i=e[Symbol.iterator]();!(t=(o=i.next()).done)&&(a.push(o.value),!r||a.length!==r);t=!0);}catch(e){n=!0,l=e}finally{try{t||null==i.return||i.return()}finally{if(n)throw l}}return a}}function _arrayWithHoles(e){if(Array.isArray(e))return e}var express=require("express"),router=express.Router(),Model_Arena=require("../models/Model_Arena"),Model_Jadwal=require("../models/Model_Jadwal"),Model_FotoArena=require("../models/Model_FotoArena"),Model_Ulasan=require("../models/Model_Ulasan");router.get("/",function(r,a){var t,n,l,o,i;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t={lokasi:r.query.lokasi||null,jenis:r.query.jenis||null},e.next=4,regeneratorRuntime.awrap(Promise.all([Model_Arena.getPublic(t),Model_Arena.getJenisOlahragaList()]));case 4:n=e.sent,l=_slicedToArray(n,2),o=l[0],i=l[1],a.render("venues/index",{title:"Cari Arena",data:o,jenisList:i,filter:t}),e.next=16;break;case 11:e.prev=11,e.t0=e.catch(0),console.error(e.t0),r.flash("error_msg","Gagal memuat halaman arena."),a.redirect("/");case 16:case"end":return e.stop()}},null,null,[[0,11]])}),router.get("/detail/:id",function(r,a){var t,n,l,o,i,s,u,d;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=r.params.id,e.next=4,regeneratorRuntime.awrap(Promise.all([Model_Arena.getById(t),Model_Jadwal.getAvailableByArenaId(t),Model_FotoArena.getByArenaId(t),Model_Ulasan.getByArena(t),Model_Ulasan.getAverageRating(t)]));case 4:if(n=e.sent,l=_slicedToArray(n,5),o=l[0],i=l[1],s=l[2],u=l[3],d=l[4],0===o.length)return r.flash("error_msg","Arena tidak ditemukan."),e.abrupt("return",a.redirect("/venues"));e.next=14;break;case 14:a.render("venues/detail",{title:o[0].nama_arena,arena:o[0],jadwal:i,fotoList:s,reviews:u,avgRating:d.avg_rating||0,totalReviews:d.total_reviews||0}),e.next=22;break;case 17:e.prev=17,e.t0=e.catch(0),console.error(e.t0),r.flash("error_msg","Gagal memuat detail arena."),a.redirect("/venues");case 22:case"end":return e.stop()}},null,null,[[0,17]])}),module.exports=router;
//# sourceMappingURL=venues_new.min.js.map
