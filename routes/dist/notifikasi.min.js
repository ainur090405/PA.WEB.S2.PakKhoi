"use strict";var express=require("express"),router=express.Router(),Model_Notifikasi=require("../models/Model_Notifikasi"),_require=require("../middleware/authMiddleware"),isAuthenticated=_require.isAuthenticated;router.get("/get",isAuthenticated,function(r,t){var a,n,s;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a=r.session.user.id,e.next=4,regeneratorRuntime.awrap(Model_Notifikasi.getByUser(a));case 4:return n=e.sent,e.next=7,regeneratorRuntime.awrap(Model_Notifikasi.getUnreadCount(a));case 7:s=e.sent,t.json({notifications:n,unreadCount:s}),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(0),console.error(e.t0),t.status(500).json({error:"Gagal mengambil notifikasi"});case 15:case"end":return e.stop()}},null,null,[[0,11]])}),router.post("/mark-read/:id",isAuthenticated,function(r,t){var a;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a=r.params.id,e.next=4,regeneratorRuntime.awrap(Model_Notifikasi.markAsRead(a));case 4:t.json({success:!0}),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),console.error(e.t0),t.status(500).json({error:"Gagal menandai notifikasi"});case 11:case"end":return e.stop()}},null,null,[[0,7]])}),router.post("/mark-all-read",isAuthenticated,function(r,t){var a;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a=r.session.user.id,e.next=4,regeneratorRuntime.awrap(Model_Notifikasi.markAllAsRead(a));case 4:t.json({success:!0}),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),console.error(e.t0),t.status(500).json({error:"Gagal menandai semua notifikasi"});case 11:case"end":return e.stop()}},null,null,[[0,7]])}),module.exports=router;
//# sourceMappingURL=notifikasi.min.js.map
