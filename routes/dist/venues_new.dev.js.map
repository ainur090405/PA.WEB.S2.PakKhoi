{"version":3,"sources":["venues_new.js"],"names":["express","require","router","Router","Model_Arena","Model_Jadwal","Model_FotoArena","Model_Ulasan","get","req","res","filter","lokasi","query","jenis","Promise","all","getPublic","getJenisOlahragaList","arenaData","jenisList","render","title","data","console","error","flash","redirect","id_arena","params","id","getById","getAvailableByArenaId","getByArenaId","getByArena","getAverageRating","jadwalData","fotoData","reviewsData","ratingData","length","nama_arena","arena","jadwal","fotoList","reviews","avgRating","avg_rating","totalReviews","total_reviews","module","exports"],"mappings":"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","sourcesContent":["// routes/venues.js\r\nconst express = require('express');\r\nconst router = express.Router();\r\nconst Model_Arena = require('../models/Model_Arena');\r\nconst Model_Jadwal = require('../models/Model_Jadwal');\r\nconst Model_FotoArena = require('../models/Model_FotoArena');\r\nconst Model_Ulasan = require('../models/Model_Ulasan');\r\n\r\n// GET: Halaman \"Cari Arena\" (Etalase)\r\nrouter.get('/', async (req, res) => {\r\n  try {\r\n    const filter = {\r\n      lokasi: req.query.lokasi || null,\r\n      jenis: req.query.jenis || null\r\n    };\r\n\r\n    const [arenaData, jenisList] = await Promise.all([\r\n      Model_Arena.getPublic(filter),\r\n      Model_Arena.getJenisOlahragaList()\r\n    ]);\r\n\r\n    res.render('venues/index', {\r\n      title: 'Cari Arena',\r\n      data: arenaData,\r\n      jenisList: jenisList,\r\n      filter: filter\r\n    });\r\n  } catch (err) {\r\n    console.error(err);\r\n    req.flash('error_msg', 'Gagal memuat halaman arena.');\r\n    res.redirect('/');\r\n  }\r\n});\r\n\r\n// ==========================================================\r\n// GET: Halaman Detail 1 Arena (UPDATED WITH REVIEWS)\r\n// ==========================================================\r\nrouter.get('/detail/:id', async (req, res) => {\r\n  try {\r\n    const id_arena = req.params.id;\r\n\r\n    // Get all data simultaneously\r\n    const [\r\n      arenaData,\r\n      jadwalData,\r\n      fotoData,\r\n      reviewsData,\r\n      ratingData\r\n    ] = await Promise.all([\r\n      Model_Arena.getById(id_arena),\r\n      Model_Jadwal.getAvailableByArenaId(id_arena),\r\n      Model_FotoArena.getByArenaId(id_arena),\r\n      Model_Ulasan.getByArena(id_arena),\r\n      Model_Ulasan.getAverageRating(id_arena)\r\n    ]);\r\n\r\n    if (arenaData.length === 0) {\r\n      req.flash('error_msg', 'Arena tidak ditemukan.');\r\n      return res.redirect('/venues');\r\n    }\r\n\r\n    // Send all data to view\r\n    res.render('venues/detail', {\r\n      title: arenaData[0].nama_arena,\r\n      arena: arenaData[0],\r\n      jadwal: jadwalData,\r\n      fotoList: fotoData,\r\n      reviews: reviewsData,\r\n      avgRating: ratingData.avg_rating || 0,\r\n      totalReviews: ratingData.total_reviews || 0\r\n    });\r\n\r\n  } catch (err) {\r\n    console.error(err);\r\n    req.flash('error_msg', 'Gagal memuat detail arena.');\r\n    res.redirect('/venues');\r\n  }\r\n});\r\n\r\nmodule.exports = router;\r\n"],"file":"venues_new.dev.js"}