{"version":3,"sources":["venues_new.js"],"names":["express","require","router","Router","Model_Arena","Model_Jadwal","Model_FotoArena","Model_Ulasan","get","req","res","filter","_ref","_ref2","arenaData","jenisList","regeneratorRuntime","async","_context","prev","next","lokasi","query","awrap","Promise","all","getPublic","getJenisOlahragaList","sent","_slicedToArray","title","data","t0","console","error","flash","redirect","stop","id_arena","_ref3","_ref4","jadwalData","fotoData","reviewsData","ratingData","_context2","params","id","getById","getAvailableByArenaId","getByArenaId","getByArena","getAverageRating","abrupt","render","nama_arena","arena","jadwal","fotoList","reviews","avgRating","avg_rating","totalReviews","total_reviews","module","exports"],"mappings":"mnBACA,IAAMA,QAAUC,QAAQ,WAClBC,OAASF,QAAQG,SACjBC,YAAcH,QAAQ,yBACtBI,aAAeJ,QAAQ,0BACvBK,gBAAkBL,QAAQ,6BAC1BM,aAAeN,QAAQ,0BAG7BC,OAAOM,IAAI,IAAK,SAAOC,EAAKC,GAAZ,IAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAA,OAAAC,mBAAAC,MAAA,SAAAC,GAAA,OAAA,OAAAA,EAAAC,KAAAD,EAAAE,MAAA,KAAA,EAAA,OAAAF,EAAAC,KAAA,EARVnB,EAAUC,CAWVoB,OAAQZ,EAAIa,MAAMD,QAAU,KAV5BnB,MAASF,EAAAA,MAAQG,OAAvB,MAOgBe,EAAAE,KAAA,EAAAJ,mBAAAO,MAOyBC,QAAQC,IAAI,CAZ/CpB,YAAYqB,UAAWf,GAcvBP,YAAYuB,0BATF,KAAA,EAAAf,EAAAM,EAAAU,KAAAf,EAAAgB,eAAAjB,EAAA,GAOLE,EAPKD,EAAA,GAOME,EAPNF,EAAA,GAHVN,EAAAA,OAAAA,eAAuB,CAgBvBuB,MAAO,aACPC,KAAMjB,EAdNC,UAAUA,EAAAJ,OAAAA,IAAAO,EAAAE,KAAA,GAAA,MAAA,KAAA,GAAAF,EAAAC,KAAA,GAAAD,EAAAc,GAAAd,EAAA,MAAA,GAAAe,QAAAC,MAAAhB,EAAAc,IAAAvB,EAAA0B,MAAA,YAAA,+BAAAzB,EAAA0B,SAAA,KAAA,KAAA,GAAA,IAAA,MAAA,OAAAlB,EAAAmB,SAAA,KAAA,KAAA,CAAA,CAAA,EAAA,QAAAnC,OAAAM,IAAA,cAAA,SAAAC,EAAAC,GAAA,IAAA4B,EAAAC,EAAAC,EAAA1B,EAAA2B,EAAAC,EAAAC,EAAAC,EAAA,OAAA5B,mBAAAC,MAAA,SAAA4B,GAAA,OAAA,OAAAA,EAAA1B,KAAA0B,EAAAzB,MAAA,KAAA,EAAA,OAAAyB,EAAA1B,KAAA,EAAAmB,EAAA7B,EAAAqC,OAAAC,GAAAF,EAAAzB,KAAA,EAAAJ,mBAAAO,MAgBVZ,QAAQA,IAAAA,CAJiBP,YAA3B4C,QAAAV,GAZYjC,aAAA4C,sBAAAX,GAAAhC,gBAAA4C,aAAAZ,GA2CV/B,aAAa4C,WAAWb,GA3Cd/B,aAAA6C,iBAAAd,MAAA,KAAA,EAAA,GAAAC,EAAAM,EAAAjB,KAAAY,EAAAX,eAAAU,EAAA,GAOMxB,EAPNyB,EAAA,GAYZ9B,EAZY8B,EAAA,GAaVV,EAbUU,EAAA,GAcVT,EAdUS,EAAA,GAeVzB,EAfUyB,EAAA,GAmBZ,IAAAP,EAAQC,OAnBI,OAoBZzB,EAAAA,MAAI0B,YAAM,0BApBEU,EAAAQ,OAAA,SAqBT3C,EAAC0B,SAAJ,YArBYS,EAAAzB,KAAA,GAAA,MAAA,KAAA,GAAAV,EAAA4C,OAAA,gBAAA,CAAAxB,MAAAhB,EAAA,GAAAyC,WAAAC,MAAA1C,EAAA,GAAA2C,OAAAhB,EAyBhBiB,SAAAhB,EACAiB,QAAAhB,EACAiB,UAAAhB,EAAAiB,YAAA,EAiCMC,aAAclB,EAAWmB,eAAiB,IA5DhClB,EAAAzB,KAAA,GAAA,MAAA,KAAA,GAAAyB,EAAA1B,KAAA,GAAA0B,EAAAb,GAAAa,EAAA,MAAA,GA4BUZ,QAAAC,MAAAW,EAAAb,IAAAvB,EAAA0B,MAAA,YAAA,8BAAAzB,EAAA0B,SAAA,WA5BV,KAAA,GAAA,IAAA,MAAA,OAAAS,EAAAR,SAAA,KAAA,KAAA,CAAA,CAAA,EAAA,QAsEhB2B,OAAOC,QAAU/D","file":"venues_new.min.js","sourcesContent":["// routes/venues.js\r\nconst express = require('express');\r\nconst router = express.Router();\r\nconst Model_Arena = require('../models/Model_Arena');\r\nconst Model_Jadwal = require('../models/Model_Jadwal');\r\nconst Model_FotoArena = require('../models/Model_FotoArena');\r\nconst Model_Ulasan = require('../models/Model_Ulasan');\r\n\r\n// GET: Halaman \"Cari Arena\" (Etalase)\r\nrouter.get('/', async (req, res) => {\r\n  try {\r\n    const filter = {\r\n      lokasi: req.query.lokasi || null,\r\n      jenis: req.query.jenis || null\r\n    };\r\n\r\n    const [arenaData, jenisList] = await Promise.all([\r\n      Model_Arena.getPublic(filter),\r\n      Model_Arena.getJenisOlahragaList()\r\n    ]);\r\n\r\n    res.render('venues/index', {\r\n      title: 'Cari Arena',\r\n      data: arenaData,\r\n      jenisList: jenisList,\r\n      filter: filter\r\n    });\r\n  } catch (err) {\r\n    console.error(err);\r\n    req.flash('error_msg', 'Gagal memuat halaman arena.');\r\n    res.redirect('/');\r\n  }\r\n});\r\n\r\n// ==========================================================\r\n// GET: Halaman Detail 1 Arena (UPDATED WITH REVIEWS)\r\n// ==========================================================\r\nrouter.get('/detail/:id', async (req, res) => {\r\n  try {\r\n    const id_arena = req.params.id;\r\n\r\n    // Get all data simultaneously\r\n    const [\r\n      arenaData,\r\n      jadwalData,\r\n      fotoData,\r\n      reviewsData,\r\n      ratingData\r\n    ] = await Promise.all([\r\n      Model_Arena.getById(id_arena),\r\n      Model_Jadwal.getAvailableByArenaId(id_arena),\r\n      Model_FotoArena.getByArenaId(id_arena),\r\n      Model_Ulasan.getByArena(id_arena),\r\n      Model_Ulasan.getAverageRating(id_arena)\r\n    ]);\r\n\r\n    if (arenaData.length === 0) {\r\n      req.flash('error_msg', 'Arena tidak ditemukan.');\r\n      return res.redirect('/venues');\r\n    }\r\n\r\n    // Send all data to view\r\n    res.render('venues/detail', {\r\n      title: arenaData[0].nama_arena,\r\n      arena: arenaData[0],\r\n      jadwal: jadwalData,\r\n      fotoList: fotoData,\r\n      reviews: reviewsData,\r\n      avgRating: ratingData.avg_rating || 0,\r\n      totalReviews: ratingData.total_reviews || 0\r\n    });\r\n\r\n  } catch (err) {\r\n    console.error(err);\r\n    req.flash('error_msg', 'Gagal memuat detail arena.');\r\n    res.redirect('/venues');\r\n  }\r\n});\r\n\r\nmodule.exports = router;\r\n"]}