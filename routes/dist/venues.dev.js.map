{"version":3,"sources":["venues.js"],"names":["express","require","router","Router","Model_Arena","Model_Jadwal","Model_FotoArena","get","req","res","filter","lokasi","query","jenis","Promise","all","getPublic","getJenisOlahragaList","arenaData","jenisList","render","title","data","console","error","flash","redirect","id_arena","params","id","getById","getAvailableByArenaId","getByArenaId","jadwalData","fotoData","length","nama_arena","arena","jadwal","fotoList","module","exports"],"mappings":"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","sourcesContent":["// routes/venues.js\r\nconst express = require('express');\r\nconst router = express.Router();\r\nconst Model_Arena = require('../models/Model_Arena');\r\nconst Model_Jadwal = require('../models/Model_Jadwal');\r\nconst Model_FotoArena = require('../models/Model_FotoArena'); // <-- 1. IMPORT MODEL FOTO\r\n\r\n// GET: Halaman \"Cari Arena\" (Etalase)\r\nrouter.get('/', async (req, res) => {\r\n  try {\r\n    const filter = {\r\n      lokasi: req.query.lokasi || null,\r\n      jenis: req.query.jenis || null\r\n    };\r\n\r\n    const [arenaData, jenisList] = await Promise.all([\r\n      Model_Arena.getPublic(filter),\r\n      Model_Arena.getJenisOlahragaList()\r\n    ]);\r\n    \r\n    res.render('venues/index', {\r\n      title: 'Cari Arena',\r\n      data: arenaData,\r\n      jenisList: jenisList,\r\n      filter: filter\r\n    });\r\n  } catch (err) {\r\n    console.error(err);\r\n    req.flash('error_msg', 'Gagal memuat halaman arena.');\r\n    res.redirect('/');\r\n  }\r\n});\r\n\r\n// ==========================================================\r\n// GET: Halaman Detail 1 Arena (INI YANG DIPERBAIKI)\r\n// ==========================================================\r\nrouter.get('/detail/:id', async (req, res) => {\r\n  try {\r\n    const id_arena = req.params.id;\r\n    \r\n    // 2. KITA AMBIL 3 DATA SEKALIGUS\r\n    const [\r\n      arenaData,\r\n      jadwalData,\r\n      fotoData      // <-- 3. AMBIL DATA FOTO\r\n    ] = await Promise.all([\r\n      Model_Arena.getById(id_arena),\r\n      Model_Jadwal.getAvailableByArenaId(id_arena),\r\n      Model_FotoArena.getByArenaId(id_arena) // <-- PANGGIL FUNGSI GALERI\r\n    ]);\r\n\r\n    if (arenaData.length === 0) {\r\n      req.flash('error_msg', 'Arena tidak ditemukan.');\r\n      return res.redirect('/venues');\r\n    }\r\n\r\n    // 4. KIRIM SEMUA DATA KE VIEW\r\n    res.render('venues/detail', {\r\n      title: arenaData[0].nama_arena,\r\n      arena: arenaData[0],\r\n      jadwal: jadwalData,\r\n      fotoList: fotoData // <-- 5. KIRIM FOTO LIST\r\n    });\r\n\r\n  } catch (err) {\r\n    console.error(err);\r\n    req.flash('error_msg', 'Gagal memuat detail arena.');\r\n    res.redirect('/venues');\r\n  }\r\n});\r\n\r\nmodule.exports = router;"],"file":"venues.dev.js"}