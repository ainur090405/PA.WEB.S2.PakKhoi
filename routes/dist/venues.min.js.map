{"version":3,"sources":["venues.js"],"names":["express","require","router","Router","Model_Arena","Model_Jadwal","Model_FotoArena","get","req","res","filter","_ref","_ref2","arenaData","jenisList","regeneratorRuntime","async","_context","prev","next","lokasi","jenis","query","awrap","Promise","all","getPublic","getJenisOlahragaList","sent","_slicedToArray","render","title","data","t0","console","error","flash","redirect","stop","id_arena","_ref3","_ref4","jadwalData","fotoData","_context2","params","id","getAvailableByArenaId","getByArenaId","length","abrupt","nama_arena","arena","jadwal","fotoList","module","exports"],"mappings":"mnBACA,IAAMA,QAAUC,QAAQ,WAClBC,OAASF,QAAQG,SACjBC,YAAcH,QAAQ,yBACtBI,aAAeJ,QAAQ,0BACvBK,gBAAkBL,QAAQ,6BAGhCC,OAAOK,IAAI,IAAK,SAAOC,EAAKC,GAAZ,IAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAA,OAAAC,mBAAAC,MAAA,SAAAC,GAAA,OAAA,OAAAA,EAAAC,KAAAD,EAAAE,MAAA,KAAA,EAAA,OAAAF,EAAAC,KAAA,EARhBR,EAAA,CACMV,OAAUC,EAAAA,MAAQmB,QAAxB,KAWMC,MAAOb,EAAIc,MAAMD,OAAS,MAJhBJ,EAAAE,KAAA,EAAAJ,mBAAAQ,MALYC,QAADC,IAA3B,CAaMrB,YAAYsB,UAAUhB,GAZtBL,YAAYsB,0BAIF,KAAA,EAAAhB,EAAAM,EAAAW,KAAAhB,EAAAiB,eAAAlB,EAAA,GALVP,EAKUQ,EAAA,GALIX,EAKJW,EAAA,GADhBH,EAAAqB,OAAA,eAAA,CAcMC,MAAO,aACPC,KAAMnB,EAdNC,UAAUA,EAAAJ,OAAAA,IAAAO,EAAAE,KAAA,GAAA,MAAA,KAAA,GAAAF,EAAAC,KAAA,GAAAD,EAAAgB,GAAAhB,EAAA,MAAA,GAAAiB,QAAAC,MAAAlB,EAAAgB,IAAAzB,EAAA4B,MAAA,YAAA,+BAAA3B,EAAA4B,SAAA,KAAA,KAAA,GAAA,IAAA,MAAA,OAAApB,EAAAqB,SAAA,KAAA,KAAA,CAAA,CAAA,EAAA,QAAApC,OAAAK,IAAA,cAAA,SAAAC,EAAAC,GAAA,IAAA8B,EAAAC,EAAAC,EAAA5B,EAAA6B,EAAAC,EAAA,OAAA5B,mBAAAC,MAAA,SAAA4B,GAAA,OAAA,OAAAA,EAAA1B,KAAA0B,EAAAzB,MAAA,KAAA,EAAA,OAAAyB,EAAA1B,KAAA,EAAAqB,EAAA/B,EAAAqC,OAAAC,GAAAF,EAAAzB,KAAA,EAAAJ,mBAAAQ,MAcVS,QAAMnB,IAAAA,CACNC,YAAAA,QAAWA,GACXJ,aAAMqC,sBAAErC,GAJiBJ,gBAA3B0C,aAAAT,MAZY,KAAA,EAAA,GAAAC,EAAAI,EAAAhB,KAAAa,EAAAZ,eAAAW,EAAA,GAOM1B,EAPN2B,EAAA,GAYZhC,EAZYgC,EAAA,GAaVV,EAbUU,EAAA,GA2Ca,IAArB5B,EAAUoC,OA3CF,OAAAzC,EAAA4B,MAAA,YAAA,0BAAAQ,EAAAM,OAAA,SAAAzC,EAAA4B,SAAA,YAAAO,EAAAzB,KAAA,GAAA,MAAA,KAAA,GAqBZV,EAAAA,OAAI4B,gBAAJ,CA6BEN,MAAOlB,EAAU,GAAGsC,WAlDVC,MAAAvC,EAAA,GAAAwC,OAAAX,EAAAY,SAAAX,IAAAC,EAAAzB,KAAA,GAAA,MAAA,KAAA,GAAAyB,EAAA1B,KAAA,GAAA0B,EAAAX,GAAAW,EAAA,MAAA,GAyBhBV,QAAAC,MAAAS,EAAAX,IACAzB,EAAA4B,MAAA,YAAA,8BACA3B,EAAA4B,SAAA,WA3BgB,KAAA,GAAA,IAAA,MAAA,OAAAO,EAAAN,SAAA,KAAA,KAAA,CAAA,CAAA,EAAA,QA+DhBiB,OAAOC,QAAUtD","file":"venues.min.js","sourcesContent":["// routes/venues.js\r\nconst express = require('express');\r\nconst router = express.Router();\r\nconst Model_Arena = require('../models/Model_Arena');\r\nconst Model_Jadwal = require('../models/Model_Jadwal');\r\nconst Model_FotoArena = require('../models/Model_FotoArena'); // <-- 1. IMPORT MODEL FOTO\r\n\r\n// GET: Halaman \"Cari Arena\" (Etalase)\r\nrouter.get('/', async (req, res) => {\r\n  try {\r\n    const filter = {\r\n      lokasi: req.query.lokasi || null,\r\n      jenis: req.query.jenis || null\r\n    };\r\n\r\n    const [arenaData, jenisList] = await Promise.all([\r\n      Model_Arena.getPublic(filter),\r\n      Model_Arena.getJenisOlahragaList()\r\n    ]);\r\n    \r\n    res.render('venues/index', {\r\n      title: 'Cari Arena',\r\n      data: arenaData,\r\n      jenisList: jenisList,\r\n      filter: filter\r\n    });\r\n  } catch (err) {\r\n    console.error(err);\r\n    req.flash('error_msg', 'Gagal memuat halaman arena.');\r\n    res.redirect('/');\r\n  }\r\n});\r\n\r\n// ==========================================================\r\n// GET: Halaman Detail 1 Arena (INI YANG DIPERBAIKI)\r\n// ==========================================================\r\nrouter.get('/detail/:id', async (req, res) => {\r\n  try {\r\n    const id_arena = req.params.id;\r\n    \r\n    // 2. KITA AMBIL 3 DATA SEKALIGUS\r\n    const [\r\n      arenaData,\r\n      jadwalData,\r\n      fotoData      // <-- 3. AMBIL DATA FOTO\r\n    ] = await Promise.all([\r\n      Model_Arena.getById(id_arena),\r\n      Model_Jadwal.getAvailableByArenaId(id_arena),\r\n      Model_FotoArena.getByArenaId(id_arena) // <-- PANGGIL FUNGSI GALERI\r\n    ]);\r\n\r\n    if (arenaData.length === 0) {\r\n      req.flash('error_msg', 'Arena tidak ditemukan.');\r\n      return res.redirect('/venues');\r\n    }\r\n\r\n    // 4. KIRIM SEMUA DATA KE VIEW\r\n    res.render('venues/detail', {\r\n      title: arenaData[0].nama_arena,\r\n      arena: arenaData[0],\r\n      jadwal: jadwalData,\r\n      fotoList: fotoData // <-- 5. KIRIM FOTO LIST\r\n    });\r\n\r\n  } catch (err) {\r\n    console.error(err);\r\n    req.flash('error_msg', 'Gagal memuat detail arena.');\r\n    res.redirect('/venues');\r\n  }\r\n});\r\n\r\nmodule.exports = router;"]}