{"version":3,"sources":["notifikasi.js"],"names":["express","require","router","Router","Model_Notifikasi","isAuthenticated","get","req","res","id_user","session","user","id","getByUser","notifications","getUnreadCount","unreadCount","json","console","error","status","post","id_notifikasi","params","markAsRead","success","markAllAsRead","module","exports"],"mappings":";;AAAA,IAAMA,OAAO,GAAGC,OAAO,CAAC,SAAD,CAAvB;;AACA,IAAMC,MAAM,GAAGF,OAAO,CAACG,MAAR,EAAf;;AACA,IAAMC,gBAAgB,GAAGH,OAAO,CAAC,4BAAD,CAAhC;;eAC4BA,OAAO,CAAC,8BAAD,C;IAA3BI,e,YAAAA,e,EAER;;;AACAH,MAAM,CAACI,GAAP,CAAW,MAAX,EAAmBD,eAAnB,EAAoC,iBAAOE,GAAP,EAAYC,GAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAE1BC,UAAAA,OAF0B,GAEhBF,GAAG,CAACG,OAAJ,CAAYC,IAAZ,CAAiBC,EAFD;AAAA;AAAA,0CAGJR,gBAAgB,CAACS,SAAjB,CAA2BJ,OAA3B,CAHI;;AAAA;AAG1BK,UAAAA,aAH0B;AAAA;AAAA,0CAINV,gBAAgB,CAACW,cAAjB,CAAgCN,OAAhC,CAJM;;AAAA;AAI1BO,UAAAA,WAJ0B;AAKhCR,UAAAA,GAAG,CAACS,IAAJ,CAAS;AAAEH,YAAAA,aAAa,EAAbA,aAAF;AAAiBE,YAAAA,WAAW,EAAXA;AAAjB,WAAT;AALgC;AAAA;;AAAA;AAAA;AAAA;AAOhCE,UAAAA,OAAO,CAACC,KAAR;AACAX,UAAAA,GAAG,CAACY,MAAJ,CAAW,GAAX,EAAgBH,IAAhB,CAAqB;AAAEE,YAAAA,KAAK,EAAE;AAAT,WAArB;;AARgC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,CAApC,E,CAYA;;AACAjB,MAAM,CAACmB,IAAP,CAAY,gBAAZ,EAA8BhB,eAA9B,EAA+C,kBAAOE,GAAP,EAAYC,GAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAErCc,UAAAA,aAFqC,GAErBf,GAAG,CAACgB,MAAJ,CAAWX,EAFU;AAAA;AAAA,0CAGrCR,gBAAgB,CAACoB,UAAjB,CAA4BF,aAA5B,CAHqC;;AAAA;AAI3Cd,UAAAA,GAAG,CAACS,IAAJ,CAAS;AAAEQ,YAAAA,OAAO,EAAE;AAAX,WAAT;AAJ2C;AAAA;;AAAA;AAAA;AAAA;AAM3CP,UAAAA,OAAO,CAACC,KAAR;AACAX,UAAAA,GAAG,CAACY,MAAJ,CAAW,GAAX,EAAgBH,IAAhB,CAAqB;AAAEE,YAAAA,KAAK,EAAE;AAAT,WAArB;;AAP2C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,CAA/C,E,CAWA;;AACAjB,MAAM,CAACmB,IAAP,CAAY,gBAAZ,EAA8BhB,eAA9B,EAA+C,kBAAOE,GAAP,EAAYC,GAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAErCC,UAAAA,OAFqC,GAE3BF,GAAG,CAACG,OAAJ,CAAYC,IAAZ,CAAiBC,EAFU;AAAA;AAAA,0CAGrCR,gBAAgB,CAACsB,aAAjB,CAA+BjB,OAA/B,CAHqC;;AAAA;AAI3CD,UAAAA,GAAG,CAACS,IAAJ,CAAS;AAAEQ,YAAAA,OAAO,EAAE;AAAX,WAAT;AAJ2C;AAAA;;AAAA;AAAA;AAAA;AAM3CP,UAAAA,OAAO,CAACC,KAAR;AACAX,UAAAA,GAAG,CAACY,MAAJ,CAAW,GAAX,EAAgBH,IAAhB,CAAqB;AAAEE,YAAAA,KAAK,EAAE;AAAT,WAArB;;AAP2C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,CAA/C;AAWAQ,MAAM,CAACC,OAAP,GAAiB1B,MAAjB","sourcesContent":["const express = require('express');\r\nconst router = express.Router();\r\nconst Model_Notifikasi = require('../models/Model_Notifikasi');\r\nconst { isAuthenticated } = require('../middleware/authMiddleware');\r\n\r\n// GET: Ambil notifikasi user (untuk AJAX)\r\nrouter.get('/get', isAuthenticated, async (req, res) => {\r\n  try {\r\n    const id_user = req.session.user.id;\r\n    const notifications = await Model_Notifikasi.getByUser(id_user);\r\n    const unreadCount = await Model_Notifikasi.getUnreadCount(id_user);\r\n    res.json({ notifications, unreadCount });\r\n  } catch (err) {\r\n    console.error(err);\r\n    res.status(500).json({ error: 'Gagal mengambil notifikasi' });\r\n  }\r\n});\r\n\r\n// POST: Tandai notifikasi sebagai dibaca\r\nrouter.post('/mark-read/:id', isAuthenticated, async (req, res) => {\r\n  try {\r\n    const id_notifikasi = req.params.id;\r\n    await Model_Notifikasi.markAsRead(id_notifikasi);\r\n    res.json({ success: true });\r\n  } catch (err) {\r\n    console.error(err);\r\n    res.status(500).json({ error: 'Gagal menandai notifikasi' });\r\n  }\r\n});\r\n\r\n// POST: Tandai semua notifikasi sebagai dibaca\r\nrouter.post('/mark-all-read', isAuthenticated, async (req, res) => {\r\n  try {\r\n    const id_user = req.session.user.id;\r\n    await Model_Notifikasi.markAllAsRead(id_user);\r\n    res.json({ success: true });\r\n  } catch (err) {\r\n    console.error(err);\r\n    res.status(500).json({ error: 'Gagal menandai semua notifikasi' });\r\n  }\r\n});\r\n\r\nmodule.exports = router;\r\n"],"file":"notifikasi.dev.js"}